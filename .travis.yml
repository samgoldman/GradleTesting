language: java
jdk:
  - oraclejdk8

before_install:
  - chmod +x gradlew
  - sudo apt-get install -y sshpass

addons:
  apt:
    update: true

before_script:
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start

jobs:
  include:
    - if: branch = master
      script: ./gradlew clean check
    - if: branch = development
      script: ./gradlew clean check
    - if: branch != master AND branch != development
      script: ./gradlew clean fastTest uiFastTest
env:
  global:
    - secure: "jFta33ehNQfeamwLrs8uiDm3kXJAGnVxBnpDp1E+SylOHuLII6gX4rNOx1GjWNUadOX4JwYYSwkVpDLLX1Bi2/1zCTFQzWHPg1HNPrhXE4n2GS/sK8hFV+oLNyQeKCsLS7R95RctPo8IuxA5KJeH61CGz+evUdQixDbyWEpgMukqyog1YAROOi8+DCZn1owo/oKto3ogxlOCbPmguEZCKBpkuMGSOCd34M/JaTnfDaznt3MKnLVpvChvLg7gJ3lDec3sDFaZDMZiy3SPmuDeCNp87CHhkWt7L8LuIwf3EBybQyBrMH2IeLO7AVIv/+KflgBRTZ72DE7ttsKwLb3bXjuMueU8xDVfX30Kpeqdhohh+i17jJab8wYg2OqN2a1ouerWec5E94q1z9Kz9vhul658CRZvg3/zPHGq4SxZhWiD3SxNJQneGi79pIRzF551PkFeZ0mgOnEzsK7zBe0yBHw5TmKAPSGFprWCYEztWeuS/DZeKg2ljTcz25sw8MWnszqkssbuovHB97tyXM5fH/dZNe/8LC7TXJ2L8JVa2WdnD+hfyNC7yCMaHouX2WVf2FEv7Jk8xW6KZdkrIJcq3wn3b6O/tFWhqB/wSBidEZsKly4CTYfmOy06g4DfES4JjAzDK8GhNap2kO/rstwSjMpZANMRHcHu+ssmIjKYtss="
    - secure: "YwLYc6Xgmqg5tLRbZ4TRw5m14V1ftB2OvL01lqFjzGU0cf6VrBIV5QnH0K1MkrBUiGL1/sssLugTXj2NfyPSerPxCXlOx6QWGQFs8qI+P60IodG6GdOSK96LPiKuw5eWrMhbb4Z+++75TY/ROI2i5PTb94LIm0X+RWDzl1hlW+q3U3tir1Rsva04xEx//+ryRBe46WGBRb09UeMo+dzdlFAQPf87Y9miX4J2wvS/OPMPUe9//E53Nhnc+/lIU9IfY9Ab5nw79Yw0A0pmQg1qnZBsjykdXX+d+6rj+/WnSzEhyPqF5j5n+HVdHT5ZQvT+2Z/ndPm/f3NMZiPRBY0Z776IKllKllUNUSrAJoy4tSiiQKiHNyx2ENkxmc3T1FQXUcUqjLJ8PFod56d/gcniUeVBFJKafEUMYsRanGU+nDbYXm9U6CyaN1cJB/rXMoB7X5PDB/ohdHQN2Qf1I9RsjgzN+r/zd1vTh5oXWcXDTSDIwvpPPrwM1pLsw0BACLL2sJDZyvl8lO0e+qd+ou29gG57hmsIc6JsCtMB5thnp0Szh/+VOA1jjUyYsMXO/KJ4KRKsPX3l4PXvqREzdHRlzKXk0eQXn3qKmKIEMKSMBmQgLdzHVwvN6a36BA/+9wEHS+0rvgbS+13grR7Dc6hX1V2Fwizu88WtA5qYG9UdSPI="


after_script:
  - zip -r build_artifacts_${TRAVIS_JOB_NUMBER}.zip ./testfx-test*.png ./build/reports/*
  - sshpass -p ${SFTP_PASSWORD} scp -o StrictHostKeyChecking=no build_artifacts_${TRAVIS_JOB_NUMBER}.zip ${SFTP_USER}@ravana.dyn.wpi.edu:public_html/